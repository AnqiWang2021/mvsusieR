<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>SUm of Single Effect (SuSiE) Regression of multivariate Y on X — msusie • mmbr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="SUm of Single Effect (SuSiE) Regression of multivariate Y on X — msusie" />
<meta property="og:description" content="SUm of Single Effect (SuSiE) Regression of multivariate Y on X" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mmbr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1.0305</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/stephenslab/mmbr">Source</a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>SUm of Single Effect (SuSiE) Regression of multivariate Y on X</h1>
    <small class="dont-index">Source: <a href='https://github.com/stephenslab/mmbr/blob/master/R/msusie.R'><code>R/msusie.R</code></a></small>
    <div class="hidden name"><code>msusie.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>SUm of Single Effect (SuSiE) Regression of multivariate Y on X</p>
    </div>

    <pre class="usage"><span class='fu'>msusie</span>(
  <span class='no'>X</span>,
  <span class='no'>Y</span>,
  <span class='kw'>L</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>prior_variance</span> <span class='kw'>=</span> <span class='fl'>0.2</span>,
  <span class='kw'>residual_variance</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>prior_weights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>standardize</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>intercept</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>estimate_residual_variance</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>estimate_prior_variance</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>estimate_prior_method</span> <span class='kw'>=</span> <span class='st'>"EM"</span>,
  <span class='kw'>check_null_threshold</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>prior_tol</span> <span class='kw'>=</span> <span class='fl'>1e-09</span>,
  <span class='kw'>compute_objective</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>s_init</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>coverage</span> <span class='kw'>=</span> <span class='fl'>0.95</span>,
  <span class='kw'>min_abs_corr</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
  <span class='kw'>compute_univariate_zscore</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>precompute_covariances</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>max_iter</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fl'>0.001</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>track_fit</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>an n by p matrix of covariates</p></td>
    </tr>
    <tr>
      <th>Y</th>
      <td><p>an n vector, or n by r matrix of response variables</p></td>
    </tr>
    <tr>
      <th>L</th>
      <td><p>maximum number of non-zero effects</p></td>
    </tr>
    <tr>
      <th>prior_variance</th>
      <td><p>Can be 1) a vector of length L, or a scalar, for scaled prior variance when Y is univariate (equivalent to `susieR::susie`);
2) a matrix for simple Multivariate regression or 3) a MASH fit that contains an array of prior covariance matrices and their weights</p></td>
    </tr>
    <tr>
      <th>residual_variance</th>
      <td><p>the residual variance (defaults to sample variance of Y)</p></td>
    </tr>
    <tr>
      <th>prior_weights</th>
      <td><p>a p vector of prior probability that each element is non-zero</p></td>
    </tr>
    <tr>
      <th>standardize</th>
      <td><p>logical flag (default=TRUE) for whether to standardize columns of X to unit variance prior to fitting.
If you do not standardize you may need
to think more carefully about specifying the scale of prior variance.
Whatever the value of standardize, the coefficients (returned from `coef`) are for X on the original input scale.
Any column of X that has zero variance is not standardized, but left as is.</p></td>
    </tr>
    <tr>
      <th>intercept</th>
      <td><p>Should intercept be fitted (default=TRUE) or set to zero (FALSE). The latter is generally not recommended.</p></td>
    </tr>
    <tr>
      <th>estimate_residual_variance</th>
      <td><p>indicates whether to estimate residual variance (currently only works for univariate Y input)</p></td>
    </tr>
    <tr>
      <th>estimate_prior_variance</th>
      <td><p>indicates whether to estimate prior (currently only works for univariate Y and for multivariate Y when prior is a single matrix)</p></td>
    </tr>
    <tr>
      <th>estimate_prior_method</th>
      <td><p>the method used for estimating prior variance: "optim", "uniroot" and "em" for univariate Y, "optim" and "simple" for multivariate Y.</p></td>
    </tr>
    <tr>
      <th>check_null_threshold</th>
      <td><p>when prior variance is estimated, compare the estimate with the null and set prior variance to null (zero) unless the log-likelihood
using the estimate is larger than that of null by this threshold. For example, you can set it to 0.1 to nudge the estimate towards zero. When used with "EM" method
setting <code>check_null_threshold=NA</code> will skip the check and instead relying solely on EM to update this parameter.</p></td>
    </tr>
    <tr>
      <th>prior_tol</th>
      <td><p>when prior variance is estimated, compare the estimated value to this tol at the end of
the analysis and exclude a single effect from PIP computation if the estimated prior variance is smaller than it.</p></td>
    </tr>
    <tr>
      <th>s_init</th>
      <td><p>a previous susie fit with which to initialize</p></td>
    </tr>
    <tr>
      <th>coverage</th>
      <td><p>coverage of confident sets. Default to 0.95 for 95% credible interval.</p></td>
    </tr>
    <tr>
      <th>min_abs_corr</th>
      <td><p>minimum of absolute value of correlation allowed in a credible set.
Default set to 0.5 to correspond to squared correlation of 0.25,
a commonly used threshold for genotype data in genetics studies.</p></td>
    </tr>
    <tr>
      <th>compute_univariate_zscore</th>
      <td><p>if TRUE outputs z-score from per variable univariate regression</p></td>
    </tr>
    <tr>
      <th>precompute_covariances</th>
      <td><p>if TRUE, precomputes various covariance quantities to speed up computations at the cost of increased memory usage</p></td>
    </tr>
    <tr>
      <th>max_iter</th>
      <td><p>maximum number of iterations to perform</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>convergence tolerance</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>if TRUE outputs some progress messages</p></td>
    </tr>
    <tr>
      <th>track_fit</th>
      <td><p>add an attribute <code>trace</code> to output that saves some current quantities of all iterations</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a susie fit, which is a list with some or all of the following elements<br /></p>
<dt>alpha</dt><dd><p>an L by p matrix of posterior inclusion probabilites</p></dd>
<dt>b1</dt><dd><p>an L by p matrix of posterior means (conditional on inclusion)</p></dd>
<dt>b2</dt><dd><p>an L by p matrix of posterior second moments (conditional on inclusion)</p></dd>
<dt>KL</dt><dd><p>an L vector of KL divergence</p></dd>
<dt>lbf</dt><dd><p>an L vector of logBF</p></dd>
<dt>sigma2</dt><dd><p>residual variance</p></dd>
<dt>V</dt><dd><p>prior variance</p></dd>
<dt>elbo</dt><dd><p>a vector of values of elbo achieved (objective function)</p></dd>
<dt>niter</dt><dd><p>number of iterations took for convergence</p></dd>
<dt>convergence</dt><dd><p>convergence status</p></dd>
<dt>sets</dt><dd><p>a list of `cs`, `purity` and selected `cs_index`</p></dd>
<dt>pip</dt><dd><p>a vector of posterior inclusion probability</p></dd>
<dt>walltime</dt><dd><p>records runtime of the fitting algorithm</p></dd>
<dt>z</dt><dd><p>a vector of univariate z-scores</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Performs Bayesian multiple linear regression of Y on X.
That is, this function
fits the regression model Y= sum_l Xb_l + e, where elements of e are iid N(0,residual_variance) and the
sum_l b_l is a p vector of effects to be estimated.
The assumption is that each b_l has exactly one non-zero element, with all elements
equally likely to be non-zero.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='no'>n</span> <span class='kw'>=</span> <span class='fl'>1000</span>
<span class='no'>p</span> <span class='kw'>=</span> <span class='fl'>1000</span>
<span class='no'>beta</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>,<span class='no'>p</span>)
<span class='no'>beta</span>[<span class='fl'>1</span>:<span class='fl'>4</span>] <span class='kw'>=</span> <span class='fl'>1</span>
<span class='no'>X</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>*<span class='no'>p</span>),<span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>n</span>,<span class='kw'>ncol</span><span class='kw'>=</span><span class='no'>p</span>)
<span class='no'>y</span> <span class='kw'>=</span> <span class='no'>X</span> <span class='kw'>%*%</span> <span class='no'>beta</span> + <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>)
<span class='no'>res</span> <span class='kw'>=</span> <span class='fu'>msusie</span>(<span class='no'>X</span>,<span class='no'>y</span>,<span class='kw'>L</span><span class='kw'>=</span><span class='fl'>10</span>)</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Gao Wang, Yuxin Zou, Peter Carbonetto, Matthew Stephens.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


