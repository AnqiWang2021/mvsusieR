% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plots.R
\name{mvsusie_plot}
\alias{mvsusie_plot}
\title{Make Bubble Heatmap to Display mvsusie Result}
\usage{
mvsusie_plot(
  m,
  weighted_effect = FALSE,
  cs_only = TRUE,
  plot_z = FALSE,
  pos = NULL,
  cslfsr_threshold = 0.05,
  add_cs = TRUE,
  min_effect_size_to_label = 0,
  font_size = 12
)
}
\arguments{
\item{m}{A mvsusie fit, typically the result of calling
\code{\link{mvsusie}}. This function only works for a mvsusie model
fitted to multivariate response data (i.e., Y with more than one
column) and a mash prior. mvsusie fits not satisfying these
conditions will result in an error.}

\item{weighted_effect}{Describe input argument "weighted_effect"
here.}

\item{cs_only}{Describe input argument "cs_only" here.}

\item{plot_z}{If \code{plot_z = TRUE}, the bubble size is
\eqn{-log_{10}(p)}, where \eqn{p} is the p-valule. The bubble color
represents effect size, the color on the x-axis represent CSs. If
\code{plot_z = FALSE}, the bubble size is \eqn{-log_{10}(y)}, where
\eqn{y} is the CS condition-specific lfsr, the bubble color
represents posterior effect size, and the color on the x-axis
represent CSs, with the non-significant CS removed.}

\item{pos}{Describe input argument "pos" here.}

\item{cslfsr_threshold}{Describe input argument "cslfsr_threshold"
here.}

\item{add_cs}{If \code{add_cs = TRUE}, information about the CSs is
added to the top of the plot.}

\item{min_effect_size_to_label}{Only variables with effect sizes
greater than \code{min_effect_size_to_label} are labeled along the
x-axis.}

\item{font_size}{Font size used in plot.}
}
\value{
Describe output here.
}
\description{
Make Bubble Heatmap to Display mvsusie Result
}
\examples{
n = 500
p = 1000
true_eff = 2
X = matrix(sample(0:2,size = n*p,replace = TRUE),nrow = n,ncol = p)
beta1 = rep(0,p)
beta2 = rep(0,p)
beta3 = rep(0,p)
beta1[1:true_eff] = runif(true_eff)
beta2[1:true_eff] = runif(true_eff)
beta3[1:true_eff] = runif(true_eff)
y1 = X \%*\% beta1 + rnorm(n)
y2 = X \%*\% beta2 + rnorm(n)
y3 = X \%*\% beta3 + rnorm(n)
Y = cbind(y1,y2,y3)
prior =
  create_mash_prior(sample_data = list(X=X,Y=Y,residual_variance=cov(Y)),
                    max_mixture_len = -1)
fit = mvsusie(X,Y,prior_variance = prior,compute_univariate_zscore = TRUE)
mvsusie_plot(fit,plot_z = FALSE)$plot
mvsusie_plot(fit,plot_z = TRUE)$plot

}
